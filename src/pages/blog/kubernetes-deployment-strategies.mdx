---
layout: ../../layouts/BlogPost.astro
title: "Kubernetes Deployment Strategies Explained"
description: "Learn about different deployment strategies in Kubernetes including Rolling Updates, Blue-Green, and Canary deployments with practical examples."
pubDate: 2024-03-24
---

# Kubernetes Deployment Strategies

## Rolling Updates (Default Strategy)
The default and safest deployment strategy that gradually replaces old pods with new ones.

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: app
spec:
  replicas: 4
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 1        # Maximum extra pods
      maxUnavailable: 1  # Maximum unavailable pods
  template:
    # Pod template...
```

### Advantages
- Zero downtime deployment
- Automatic rollback capability
- Low risk and resource usage

## Blue-Green Deployment
Runs two identical environments, switching traffic from old (blue) to new (green) version.

```yaml
# Green deployment
apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-green
spec:
  replicas: 3
  template:
    metadata:
      labels:
        app: myapp
        version: green
    # Pod template...
---
# Service (initially pointing to blue)
apiVersion: v1
kind: Service
metadata:
  name: app
spec:
  selector:
    app: myapp
    version: blue  # Switch to 'green' to cutover
  ports:
    - port: 80
```

### Advantages
- Instant rollback capability
- Zero downtime
- Testing new version before switch

## Canary Deployment
Gradually routes traffic to new version, testing with subset of users.

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: app-ingress
  annotations:
    nginx.ingress.kubernetes.io/canary: "true"
    nginx.ingress.kubernetes.io/canary-weight: "20"
spec:
  rules:
    - host: app.example.com
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: app-canary
                port:
                  number: 80
```

### Advantages
- Risk mitigation
- Early feedback
- Gradual rollout

## A/B Testing
Similar to canary but focuses on testing features with specific user groups.

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    nginx.ingress.kubernetes.io/canary: "true"
    nginx.ingress.kubernetes.io/canary-by-header: "User-Agent"
    nginx.ingress.kubernetes.io/canary-by-header-value: "Mobile"
spec:
  # Ingress spec...
```

### Advantages
- Feature testing
- User behavior analysis
- Targeted rollouts

## Best Practices

1. **Health Checks**
```yaml
spec:
  template:
    spec:
      containers:
      - name: app
        readinessProbe:
          httpGet:
            path: /health
            port: 8080
          initialDelaySeconds: 5
          periodSeconds: 10
        livenessProbe:
          httpGet:
            path: /health
            port: 8080
```

2. **Resource Management**
```yaml
spec:
  template:
    spec:
      containers:
      - name: app
        resources:
          requests:
            memory: "64Mi"
            cpu: "250m"
          limits:
            memory: "128Mi"
            cpu: "500m"
```

3. **Rollback Strategy**
```yaml
kubectl rollout history deployment/app
kubectl rollout undo deployment/app --to-revision=2
```

## Strategy Selection Guide

Choose based on:
- Application architecture
- Business requirements
- Risk tolerance
- Resource availability
- Monitoring capabilities

| Strategy | Use Case | Risk Level | Resource Usage |
|----------|----------|------------|----------------|
| Rolling Update | General deployments | Low | Low |
| Blue-Green | Critical applications | Medium | High |
| Canary | Feature testing | Low-Medium | Medium |
| A/B Testing | User testing | Low | Medium |